# This is a MySQL-wsrep package description for ESP package manager

%product     wsrep-enabled MySQL server
%copyright   MySQL AB, Codership Oy, All Rights Reserved
%vendor      Codership Oy
%license     COPYING
%readme      README
%description MySQL server + wsrep patch (https://launchpad.net/codership-mysql).
$mysql_version=${MYSQL_VER}
$wsrep_version=${WSREP_VER}
%version     ${mysql_version}-${wsrep_version}

# This includes dependencies and directory structore information
%format deb
%include debian/mysql-wsrep.list
%format rpm
%include centos/mysql-wsrep.list
%format all

##############################################
# Below files sorted into paragraphs         #
# according to Debian division into packages #
##############################################

# Documentation
d 755 root root $DOCS_DST -
f 644 root root $DOCS_DST/COPYING           $MYSQL_SRC/COPYING
f 644 root root $DOCS_DST/EXCEPTIONS-CLIENT $MYSQL_SRC/EXCEPTIONS-CLIENT
f 644 root root $DOCS_DST/README            $MYSQL_SRC/README
f 644 root root $DOCS_DST/README-wsrep      ${GALERA_SRC}/scripts/mysql/README-wsrep

# mysql-common part (see distribution-specific includes too)
d 755 root  root  $CONF_DST/conf.d             -
c 640 mysql mysql $CONF_DST/conf.d/wsrep.cnf   $MYSQL_SRC/support-files/wsrep.cnf

# mysql-server-5.1 part
d 755 root root $BINS_DST -
f 644 root root $CONF_DST/conf.d/mysqld_safe_syslog.cnf $GALERA_SRC/scripts/mysql/debian/mysqld_safe_syslog.cnf
f 755 root root $BINS_DST/msql2mysql           $MYSQL_SRC/scripts/msql2mysql
f 755 root root $BINS_DST/my_print_defaults    $MYSQL_SRC/extra/my_print_defaults
%format rpm
f 755 root root $BINS_DST/innochecksum         $MYSQL_SRC/extra/innochecksum
%format all
f 755 root root $BINS_DST/myisamchk            $MYSQL_SRC/storage/myisam/myisamchk
f 755 root root $BINS_DST/myisamlog            $MYSQL_SRC/storage/myisam/myisamlog
f 755 root root $BINS_DST/myisampack           $MYSQL_SRC/storage/myisam/myisampack
f 755 root root $BINS_DST/mysql_convert_table_format $MYSQL_SRC/scripts/mysql_convert_table_format
%format rpm
f 755 root root $BINS_DST/mysql_fix_extensions $MYSQL_SRC/scripts/mysql_fix_extensions
%format all
f 755 root root $BINS_DST/mysql_fix_privilege_tables $MYSQL_SRC/scripts/mysql_fix_privilege_tables
f 755 root root $BINS_DST/mysql_install_db     $MYSQL_SRC/scripts/mysql_install_db
f 755 root root $BINS_DST/mysql_secure_installation $MYSQL_SRC/scripts/mysql_secure_installation
f 755 root root $BINS_DST/mysql_setpermission  $MYSQL_SRC/scripts/mysql_setpermission
f 755 root root $BINS_DST/mysql_tzinfo_to_sql  $MYSQL_SRC/sql/mysql_tzinfo_to_sql
f 755 root root $BINS_DST/mysql_upgrade        $MYSQL_SRC/client/.libs/mysql_upgrade
f 755 root root $BINS_DST/mysql_zap            $MYSQL_SRC/scripts/mysql_zap
# Official RPMs have mysqlbinlog in client package
%format deb
f 755 root root $BINS_DST/mysqlbinlog          $MYSQL_SRC/client/.libs/mysqlbinlog
%format all
f 755 root root $BINS_DST/mysqld_multi         $MYSQL_SRC/scripts/mysqld_multi
f 755 root root $BINS_DST/mysqld_safe          $MYSQL_SRC/scripts/mysqld_safe
f 755 root root $BINS_DST/mysqlhotcopy         $MYSQL_SRC/scripts/mysqlhotcopy
f 755 root root $BINS_DST/mysqltest            $MYSQL_SRC/client/.libs/mysqltest
f 755 root root $BINS_DST/perror               $MYSQL_SRC/extra/perror
f 755 root root $BINS_DST/replace              $MYSQL_SRC/extra/replace
f 755 root root $BINS_DST/resolve_stack_dump   $MYSQL_SRC/extra/resolve_stack_dump
f 755 root root $BINS_DST/resolveip            $MYSQL_SRC/extra/resolveip
f 755 root root $BINS_DST/mysqlhotcopy         $MYSQL_SRC/scripts/mysqlhotcopy
f 755 root root $BINS_DST/wsrep_sst_mysqldump  $MYSQL_SRC/scripts/wsrep_sst_mysqldump
f 644 root root $BINS_DST/wsrep_sst_mysqldump_fix.sql  $MYSQL_SRC/scripts/wsrep_sst_mysqldump_fix.sql

f 644 root root $SHAR_DST/errmsg.txt           $MYSQL_SRC/sql/share/errmsg.txt
f 644 root root $SHAR_DST/mysqld_multi.server  $MYSQL_SRC/support-files/mysqld_multi.server
f 644 root root $SHAR_DST                      $MYSQL_SRC/scripts/*.sql

d 755 root root $DOCS_DST/examples -
f 644 root root $DOCS_DST/examples             $MYSQL_SRC/support-files/*.cnf

d 755 mysql root /var/run/mysqld -
d 755 mysql adm  /var/log/mysql  -

# mysql-server-core-5.1
d 755 root root $LIBEXEC_DST -
f 755 root root $LIBEXEC_DST/mysqld            $MYSQL_SRC/sql/mysqld
%format deb
d 755 root root $SBIN_DST -
l 000 root root $SBIN_DST/mysqld               ../libexec/mysqld
%format all
d 755 root root $SHAR_DST/english -
f 644 root root $SHAR_DST/english/errmsg.sys   $MYSQL_SRC/sql/share/english/errmsg.sys
d 755 root root $SHAR_DST/charsets -
f 644 root root $SHAR_DST/charsets             $MYSQL_SRC/sql/share/charsets/*

# manpages
d 755 root root $MAN_DST/man1 -
%format rpm
f 644 root root $MAN_DST/man1/innochecksum.1.gz      $MYSQL_SRC/man/innochecksum.1.gz
%format deb
f 644 root root $MAN_DST/man1/msql2mysql.1.gz        $MYSQL_SRC/man/msql2mysql.1.gz
%format all
f 644 root root $MAN_DST/man1/myisamchk.1.gz         $MYSQL_SRC/man/myisamchk.1.gz
f 644 root root $MAN_DST/man1/myisamlog.1.gz         $MYSQL_SRC/man/myisamlog.1.gz
f 644 root root $MAN_DST/man1/myisampack.1.gz        $MYSQL_SRC/man/myisampack.1.gz
f 644 root root $MAN_DST/man1/my_print_defaults.1.gz $MYSQL_SRC/man/my_print_defaults.1.gz
%format deb
f 644 root root $MAN_DST/man1/mysqlbinlog.1.gz       $MYSQL_SRC/man/mysqlbinlog.1.gz
%format all
f 644 root root $MAN_DST/man1/mysql_convert_table_format.1.gz $MYSQL_SRC/man/mysql_convert_table_format.1.gz
f 644 root root $MAN_DST/man1/mysqld_multi.1.gz      $MYSQL_SRC/man/mysqld_multi.1.gz
f 644 root root $MAN_DST/man1/mysqld_safe.1.gz       $MYSQL_SRC/man/mysqld_safe.1.gz
%format rpm
f 644 root root $MAN_DST/man1/mysql_fix_extensions.1.gz $MYSQL_SRC/man/mysql_fix_extensions.1.gz
%format all
f 644 root root $MAN_DST/man1/mysql_fix_privilege_tables.1.gz $MYSQL_SRC/man/mysql_fix_privilege_tables.1.gz
f 644 root root $MAN_DST/man1/mysqlhotcopy.1.gz      $MYSQL_SRC/man/mysqlhotcopy.1.gz
f 644 root root $MAN_DST/man1/mysql_install_db.1.gz  $MYSQL_SRC/man/mysql_install_db.1.gz
f 644 root root $MAN_DST/man1/mysql_secure_installation.1.gz $MYSQL_SRC/man/mysql_secure_installation.1.gz
f 644 root root $MAN_DST/man1/mysql_setpermission.1.gz $MYSQL_SRC/man/mysql_setpermission.1.gz
f 644 root root $MAN_DST/man1/mysqltest.1.gz         $MYSQL_SRC/man/mysqltest.1.gz
f 644 root root $MAN_DST/man1/mysql_tzinfo_to_sql.1.gz $MYSQL_SRC/man/mysql_tzinfo_to_sql.1.gz
f 644 root root $MAN_DST/man1/mysql_upgrade.1.gz     $MYSQL_SRC/man/mysql_upgrade.1.gz
f 644 root root $MAN_DST/man1/mysql_zap.1.gz         $MYSQL_SRC/man/mysql_zap.1.gz
f 644 root root $MAN_DST/man1/perror.1.gz            $MYSQL_SRC/man/perror.1.gz
f 644 root root $MAN_DST/man1/replace.1.gz           $MYSQL_SRC/man/replace.1.gz
f 644 root root $MAN_DST/man1/resolveip.1.gz         $MYSQL_SRC/man/resolveip.1.gz
f 644 root root $MAN_DST/man1/resolve_stack_dump.1.gz $MYSQL_SRC/man/resolve_stack_dump.1.gz
d 755 root root $MAN_DST/man8 -
f 644 root root $MAN_DST/man8/mysqld.8.gz           $MYSQL_SRC/man/mysqld.8.gz

#
