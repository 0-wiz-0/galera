===============
 Write Set Replication
===============
Write sets budle database writes into *write set* messages.
Replicating these sets over database nodes is called write set
replication (wsrep).

Galera write set replication consists of two software entities:
- wsrep Application Programming Interface (API)
- wsrep provider

The roles of wsrep API and wsrep provider in the replication
architecture are depicted in the figure below:

|replicationarchitecture|

---------------
 wsrep API
---------------
wsrep API is a generic replication plugin interface for databases.
The API defines a set of application callbacks and replication
library calls. 

The wsrep API is used in a replication model where an application, such
as a database server, has a state. In practice, the state refers to the
contents of the database. When the database is used, clients modify the
database contents and the database state changes. This changing of the
state is represented as a series of atomic changes (transactions). In
a database cluster, all nodes always have the same state, which they
synchronize with each other by replicating and applying state changes
in the same serial order.

To keep the state identical on all nodes, the wsrep API uses a global
transaction ID (GTID), which is used to both:

- Identify the state change
- Identify the state itself by the ID of the last state change

The GTID consists of:

- A state UUID, which uniquely identifies the state and the
  sequence of changes it undergoes
- An ordinal sequence number (seqno, a 64-bit signed integer)
  to denote the position of the change in the sequence
  
By using the GTID, you can
- Compare the application states
- Establish the order of state changes
- Determine whether the change was applied or not
- Whether the change is applicable at all to a given state (in short, whether it is all-powerful)

In a human-readable format, the GTID might look like this::

    45eec521-2f34-11e0-0800-2a36050b826b:94530586304


---------------
 Galera wsrep Provider
---------------
wsrep provider is the library that provides wsrep API calls. This library
can be dynamically loaded by any wsrep-enabled application. Galera is a
wsrep provider that implements true multi-master synchronous replication.



.. |replicationarchitecture| image:: replicationarchitecture.png
   :height: 322
   :width: 266