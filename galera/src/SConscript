
env = DefaultEnvironment().Clone()

env.Replace(CXXFLAGS = env['CXXFLAGS'].replace('-pedantic',''))
env.Append(CXXFLAGS = ' -DGALERA_LOG_H_ENABLE_CXX')


#env.SharedLibrary('mmgalera', [
#        'galera_info.c',
#        'galera_job_queue.c',
#        'galera_options.c',
#        'galera_state.c',
#        'galera_status.c',
#        'mm_galera.c'
#])

galera_common_srcs = Split('''
        mapped_buffer.cpp
        write_set.cpp
        trx_handle.cpp
        wsdb.cpp
        certification.cpp
        galera_service_thd.cpp
        wsrep_params.cpp
''')

env.StaticLibrary('galera++', galera_common_srcs)
#env.StaticLibrary('galera++', [
#        'mapped_buffer.cpp',
#        'write_set.cpp',
#        'trx_handle.cpp',
#        'wsdb.cpp',
#        'certification.cpp',
#        'galera_service_thd.cpp',
#])

env.SharedLibrary('galera++', galera_common_srcs)
#env.SharedLibrary('galera++', [
#        'mapped_buffer.cpp',
#        'write_set.cpp',
#        'trx_handle.cpp',
#        'wsdb.cpp',
#        'certification.cpp',
#        'galera_service_thd.cpp',
#])


mmenv = env.Clone()
mmenv.Append(CPPFLAGS = ' -DGALERA_MULTIMASTER')
mmenv.Replace(SHOBJPREFIX = 'libmmgalera++-')
mmenv.SharedLibrary('mmgalera++', [
        'galera_info.c',
        'replicator_smm.cpp',
        'replicator_smm_stats.cpp',
        'replicator_smm_params.cpp',
        'wsrep_provider.cpp'
])

#        'galera_job_queue.c',
#        'galera_options.c',

